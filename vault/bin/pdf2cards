#!/bin/bash 

# This script is called ONLY from within make 
# $1 = source.pdf 
# Nevertheless, we check to ensure that the passed PDF has been 
# generated by LaTeX/XeTeX 

# generator=$(pdfinfo $1 | grep Creator | sed -e "s/Creator:[[:space:]]*//g")
# if [[ $generator == "TeX" || $generator =~ ^dvips ]] ; then 

generator=$(pdfinfo $1 | grep Creator) 
if [[ $generator =~ "TeX" ]] ; then  
  # Output: tex-%d.svg 

  pdf2svg $1 tex-%d.svg all 
  for f in `ls tex-*.svg` ; do 
    # n=$(basename $f | cut -d'.' -f1 | cut -d'-' -f2)
    svgclip.py -o $f $f 
  done 
fi
