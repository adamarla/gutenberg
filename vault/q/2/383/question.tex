

\question Let $R(A, B)$ and $S(A, B)$ be two relations and assume that:\\
(i) their attributes have the same type; \\
(ii) both relations have NOT NULL check constraints on B. \\
Two queries are equivalent if they compute the same set of answers for 
every database instance. With this in mind, in the following questions,
complete the query on the right, so that it is equivalent to the one on
the left. 

\begin{parts}
  \part[3]   
  \begin{tabular}{ll|ll}
    SELECT &$R.B$                     &SELECT &\underline{\hspace{20pt}} \\
    FROM   &$R$                       &FROM   &\underline{\hspace{20pt}} \\
    INNER JOIN &$S$ ON $(R.A = S.A)$; &WHERE  &\underline{\hspace{20pt}} IN \underline{\hspace{20pt}};\\
  \end{tabular}\\

\begin{solution}[\halfpage]
    The query on the left is a normal join operation. The equivalent form
    on the right would be\\
    \begin{tabular}{ll}
      SELECT &$B$ \\
      FROM   &$R$ \\
      WHERE  &$A$ IN (SELECT $A$ FROM $S$); \\
    \end{tabular}
  \end{solution}

  \part[3] 
  \begin{tabular}{ll|ll}
    SELECT &$A$        &SELECT &\underline{\hspace{20pt}} \\
    FROM   &$R$        &FROM   &\underline{\hspace{20pt}};\\
    GROUP BY &$(A,B)$; &       &\\
  \end{tabular}\\

\begin{solution}[\mcq]
    The query on the left is simply a listing of $A$ from $R$,\\
    \begin{tabular}{ll}
      SELECT &$R.A$ \\
      FROM   &$R$; \\
    \end{tabular}
  \end{solution}

  \part[4] 
  \begin{tabular}{ll|ll}
    SELECT &MIN$(B)$ AS $B$ &SELECT &$R.B$ \\
    FROM   &$R$;            &FROM   &$R$ \\
           &                &WHERE  &\underline{\hspace{20pt}} <= ALL \underline{\hspace{20pt}};\\
  \end{tabular}\\

\begin{solution}[\mcq]
    To find the minimum $B$, perform a comparison with the entire set,\\
    \begin{tabular}{ll}
      SELECT &$R.B$ \\
      FROM   &$R$ \\
      WHERE  &$R.B$ <= ALL (SELECT $B$ FROM $R$);
    \end{tabular}
  \end{solution}

\end{parts}

